<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Re√ßu BNP Paribas - √âditable (Avec mot de passe)</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f3f3f3;
      display: flex;
      gap: 20px;
      padding: 20px;
    }
    form {
      background: white;
      padding: 15px;
      border-radius: 5px;
      box-shadow: 0 0 6px rgba(0,0,0,0.1);
      width: 320px;
    }
    label {
      display: block;
      font-size: 14px;
      margin-top: 8px;
    }
    input, select {
      width: 100%;
      padding: 6px;
      margin-top: 2px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
    }
    .receipt {
      width: 360px;
      background: white;
      padding: 15px;
      border: 1px solid #ccc;
      box-shadow: 0 0 6px rgba(0,0,0,0.1);
      font-family: monospace;
    }
    .logo {
      text-align: center;
      margin-bottom: 8px;
    }
    .logo img {
      max-width: 90px;
      max-height: 60px;
      object-fit: contain;
    }
    .title {
      text-align: center;
      font-weight: bold;
      font-size: 16px;
      margin-bottom: 12px;
      border-bottom: 1px dashed #000;
      padding-bottom: 4px;
    }
    .line {
      display: flex;
      justify-content: space-between;
      margin: 4px 0;
      font-size: 14px;
    }
    .line span:first-child { font-weight: 600; }
    .qr {
      text-align: center;
      margin-top: 14px;
    }
    .code {
      text-align: center;
      font-size: 12px;
      margin-top: 4px;
    }
    .footer {
      text-align: center;
      font-size: 11px;
      margin-top: 10px;
      border-top: 1px dashed #000;
      padding-top: 5px;
    }
    button { cursor: pointer; }

    /* üì± Version mobile */
    @media (max-width: 600px) {
      body {
        flex-direction: column;
        align-items: center;
        padding: 10px;
        gap: 10px;
      }
      form, .receipt {
        width: 100% !important;
        max-width: 100%;
      }
      .receipt {
        font-size: 14px;
      }
      .logo img {
        max-width: 70px;
      }
    }
  </style>
</head>
<body>

  <form id="editorForm">
    <h3>Modifier le Re√ßu</h3>
    
    <label>Logo (URL ou t√©l√©verser) :</label>
    <input type="url" id="logoUrl" value="https://upload.wikimedia.org/wikipedia/commons/b/b2/BNP_Paribas.png" placeholder="URL du logo">
    <input type="file" id="logoFile" accept="image/*">

    <label>B√©n√©ficiaire:</label>
    <input type="text" id="beneficiaire" value="MARIA TEREVANNI LUCENA DE SOUZA">

    <label>Titulaire:</label>
    <input type="text" id="titulaire" value="V√©ronique AGALOT">

    <label>Montant:</label>
    <input type="text" id="montant" value="360 000,00 EUR">

    <label>N¬∞ Compte:</label>
    <input type="text" id="compte" value="6.508-0">

    <label>Banque:</label>
    <input type="text" id="banque" value="BNP PARIBAS">

    <label>Commission:</label>
    <input type="text" id="commission" value="8.600 Reais">

    <label>Date/Heure:</label>
    <input type="text" id="date" value="12/08/2025 13:24">

    <label>Code R√©f√©rence:</label>
    <input type="text" id="codeRef" value="3991CB03F637714">

    <!-- Taille du re√ßu -->
    <label>Largeur du re√ßu (px):</label>
    <input type="number" id="receiptWidth" value="360">

    <label>Hauteur du re√ßu (px ou 'auto'):</label>
    <input type="text" id="receiptHeight" value="550">

    <!-- S√©lecteur de langue -->
    <label>Langue du re√ßu :</label>
    <select id="receiptLanguage">
      <option value="fr">Fran√ßais</option>
      <option value="en">English</option>
      <option value="es">Espa√±ol</option>
      <option value="pt">Portugu√™s</option>
      <option value="pt-BR">Portugu√™s (Brasil)</option>
      <option value="it">Italiano</option>
      <option value="de">Deutsch</option>
      <option value="nl">Nederlands</option>
      <option value="hr">Hrvatski</option>
    </select>

    <button type="button" id="updateBtn" style="margin-top:10px;width:100%;padding:8px;">Mettre √† jour</button>
    <button type="button" id="downloadBtn" style="margin-top:10px;width:100%;padding:8px;background:#2196F3;color:white;">T√©l√©charger le re√ßu</button>
    <button type="button" id="changePwdBtn" style="margin-top:10px;width:100%;padding:8px;background:#FF9800;color:white;">Changer le mot de passe</button>
  </form>

  <div class="receipt" id="receiptPreview">
    <div class="logo">
      <img id="r_logo" src="https://upload.wikimedia.org/wikipedia/commons/b/b2/BNP_Paribas.png" alt="logo">
    </div>
    <div class="title" data-i18n="title">RE√áU DE VIREMENT</div>
    <div class="line"><span data-i18n="beneficiary">B√©n√©ficiaire</span><span id="r_beneficiaire">MARIA TEREVANNI LUCENA DE SOUZA</span></div>
    <div class="line"><span data-i18n="account_holder">Titulaire</span><span id="r_titulaire">V√©ronique AGALOT</span></div>
    <div class="line"><span data-i18n="amount">Montant</span><span id="r_montant">360 000,00 EUR</span></div>
    <div class="line"><span data-i18n="account_no">N¬∞ Compte</span><span id="r_compte">6.508-0</span></div>
    <div class="line"><span data-i18n="bank">Banque</span><span id="r_banque">BNP PARIBAS</span></div>
    <div class="line"><span data-i18n="commission">Commission</span><span id="r_commission">8.600 Reais</span></div>
    <div class="line"><span data-i18n="date_time">Date/Heure</span><span id="r_date">12/08/2025 13:24</span></div>
    <div class="qr"><img id="qr_code" src="https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=3991CB03F637714" alt="qr"></div>
    <div class="code" id="r_code">3991CB03F637714</div>
    <div class="footer">
      <div data-i18n="footer1">Merci d‚Äôavoir utilis√© BNP Paribas</div>
      <div data-i18n="footer2">Conservez ce re√ßu pour vos archives</div>
    </div>
  </div>

<!-- Import html2canvas -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<script>
  const defaultTexts = {};
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('[data-i18n]').forEach(el => {
      defaultTexts[el.dataset.i18n] = el.textContent.trim();
    });
  });

  const translations = { /* ... m√™mes traductions que ton code original ... */ };

  function translateReceipt(lang) { /* ... m√™me code de traduction ... */ }

  function updateReceipt() { /* ... m√™me code update ... */ }

  function downloadReceipt() { /* ... m√™me code t√©l√©chargement ... */ }

  document.getElementById('updateBtn').addEventListener('click', updateReceipt);
  document.getElementById('downloadBtn').addEventListener('click', downloadReceipt);
  document.getElementById('receiptLanguage').addEventListener('change', function(){
    translateReceipt(this.value);
  });

  // Mot de passe
  let password = localStorage.getItem("receiptPwd") || "271263";

  function askPassword() {
    let tries = 3;
    while (tries > 0) {
      let input = prompt("Entrez le mot de passe pour acc√©der au re√ßu :");
      if (input === password) {
        return true;
      } else {
        alert("Mot de passe incorrect !");
        tries--;
      }
    }
    document.body.innerHTML = "<h2 style='color:red;text-align:center;'>Acc√®s refus√©</h2>";
    return false;
  }

  document.getElementById("changePwdBtn").addEventListener("click", () => {
    let oldPwd = prompt("Entrez l'ancien mot de passe :");
    if (oldPwd === password) {
      let newPwd = prompt("Entrez le nouveau mot de passe :");
      if (newPwd && newPwd.trim() !== "") {
        password = newPwd.trim();
        localStorage.setItem("receiptPwd", password);
        alert("Mot de passe chang√© avec succ√®s !");
      } else {
        alert("Nouveau mot de passe invalide !");
      }
    } else {
      alert("Ancien mot de passe incorrect !");
    }
  });

  window.addEventListener('load', () => {
    if (askPassword()) {
      updateReceipt();
    }
  });
</script>

</body>
</html>
